<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Detective Game - Step 4 (Complete!)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 18px;
            line-height: 1.6;
            background-color: #000;
            color: #fff;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            color: #ffff00;
            text-align: center;
            font-size: 28px;
        }
        
        .game-container {
            background-color: #222;
            padding: 30px;
            border-radius: 10px;
            border: 3px solid #ffff00;
            margin: 20px 0;
        }
        
        .instructions {
            background-color: #003366;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 2px solid #00ccff;
        }
        
        .game-input {
            margin: 20px 0;
            text-align: center;
        }
        
        input[type="number"] {
            font-size: 24px;
            padding: 15px;
            width: 120px;
            text-align: center;
            border: 3px solid #00ccff;
            border-radius: 5px;
            background-color: #fff;
            color: #000;
        }
        
        button {
            font-size: 20px;
            padding: 15px 30px;
            margin: 10px;
            border: 3px solid #00ff00;
            border-radius: 5px;
            background-color: #00ff00;
            color: #000;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #00cc00;
        }
        
        button:focus {
            outline: 3px solid #ffff00;
        }
        
        #result {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #ffff00;
            border-radius: 5px;
            background-color: #333;
            min-height: 60px;
            text-align: center;
            font-size: 20px;
            color: #ffff00;
        }
        
        .correct {
            background-color: #003300 !important;
            border-color: #00ff00 !important;
            color: #00ff00 !important;
        }
        
        .too-high {
            background-color: #330000 !important;
            border-color: #ff6666 !important;
            color: #ff6666 !important;
        }
        
        .too-low {
            background-color: #000033 !important;
            border-color: #6666ff !important;
            color: #6666ff !important;
        }
        
        .audio-controls {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background-color: #444;
            border-radius: 5px;
            border: 2px solid #ffff00;
        }
        
        .audio-controls button {
            background-color: #ffff00;
            color: #000;
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
        }
        
        .stats {
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            background-color: #444;
            border-radius: 5px;
            color: #00ccff;
        }
    </style>
</head>
<body>
    <h1>üïµÔ∏è Number Detective Game üîç</h1>
    
    <div class="game-container">
        <div class="instructions">
            <h2>How to Play:</h2>
            <p>I'm thinking of a secret number between 1 and 10!</p>
            <p>Can you guess what it is? I'll give you clues to help you!</p>
            <p>üîä Turn on your sound - the game will talk to you! üîä</p>
            <p>Let's see how good a detective you are! üîç</p>
        </div>
        
        <div class="audio-controls">
            <h3>üîä Audio Settings:</h3>
            <button id="testAudio">Test Audio üîä</button>
            <button id="muteToggle">üîá Mute/Unmute</button>
            <br>
            <label for="speechRate">Speech Speed:</label>
            <input type="range" id="speechRate" min="0.5" max="2" step="0.1" value="1">
        </div>
        
        <div class="game-input">
            <label for="guess">Enter your guess (1-10):</label><br><br>
            <input type="number" id="guess" min="1" max="10" placeholder="?"><br><br>
            <button id="submitGuess">Make My Guess! üîç</button>
            <button id="newGame">New Game üéÆ</button>
        </div>
        
        <div class="stats">
            <div id="gameStats">Guesses: 0 | Games Won: 0</div>
        </div>
        
        <div id="result">
            Ready for your first guess! The game will speak to you too!
        </div>
    </div>

    <script>
        // VARIABLES - These store information for our game
        let secretNumber = Math.floor(Math.random() * 10) + 1; // Random number 1-10!
        let guessCount = 0; // Keep track of how many guesses
        let gamesWon = 0; // Keep track of victories!
        let audioEnabled = true; // Audio on/off
        let speechRate = 1; // How fast the computer talks
        
        // SPEECH SYNTHESIS - This makes the computer talk to us!
        const synth = window.speechSynthesis;
        
        console.log("Psst! The secret number is: " + secretNumber); // Cheat code for testing!
        
        // AUDIO FUNCTIONS - These handle all our sound effects
        function speak(text, options = {}) {
            if (!audioEnabled) return; // Don't speak if muted
            
            // Cancel any current speech
            synth.cancel();
            
            // Create the speech
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = speechRate;
            utterance.pitch = options.pitch || 1;
            utterance.volume = options.volume || 0.8;
            
            // Speak it!
            synth.speak(utterance);
        }
        
        function playSuccessSound() {
            if (!audioEnabled) return;
            
            // Create success sound using Web Audio API
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Play a happy ascending melody
            oscillator.frequency.setValueAtTime(523, audioContext.currentTime); // C
            oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.2); // E  
            oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.4); // G
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.6);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.6);
        }
        
        function playHintSound(isHigh) {
            if (!audioEnabled) return;
            
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // High frequency for "too high", low for "too low"
            oscillator.frequency.value = isHigh ? 800 : 300;
            
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }
        
        // GAME FUNCTIONS
        function updateStats() {
            document.getElementById('gameStats').innerText = 
                `Guesses: ${guessCount} | Games Won: ${gamesWon}`;
        }
        
        function checkGuess() {
            // Get the player's guess and convert it to a number
            let playerGuess = parseInt(document.getElementById('guess').value);
            
            // Check if it's a valid number
            if (isNaN(playerGuess) || playerGuess < 1 || playerGuess > 10) {
                const message = "Please enter a number between 1 and 10!";
                document.getElementById('result').innerText = message;
                speak(message);
                return;
            }
            
            // Get the result area so we can show messages
            let resultArea = document.getElementById('result');
            
            // Count this guess
            guessCount++;
            updateStats();
            
            // IF/ELSE STATEMENTS - This is how our game makes decisions!
            
            if (playerGuess === secretNumber) {
                // CORRECT! They won!
                const message = `üéâ AMAZING! You found it! The number was ${secretNumber}! You did it in ${guessCount} guesses! üéâ`;
                resultArea.innerText = message;
                resultArea.className = "correct";
                
                // Audio celebration!
                speak(`Fantastic! You got it! The secret number was ${secretNumber}. You solved it in ${guessCount} guesses! You're an excellent detective!`, {pitch: 1.2});
                playSuccessSound();
                
                gamesWon++;
                updateStats();
                
            } else if (playerGuess < secretNumber) {
                // Too low!
                const message = `üìà Too low! The secret number is HIGHER than ${playerGuess}. Try a bigger number!`;
                resultArea.innerText = message;
                resultArea.className = "too-low";
                
                speak(`Too low! Try a number higher than ${playerGuess}`);
                playHintSound(false); // Low sound for "too low"
                
            } else if (playerGuess > secretNumber) {
                // Too high!
                const message = `üìâ Too high! The secret number is LOWER than ${playerGuess}. Try a smaller number!`;
                resultArea.innerText = message;
                resultArea.className = "too-high";
                
                speak(`Too high! Try a number lower than ${playerGuess}`);
                playHintSound(true); // High sound for "too high"
            }
            
            // Clear the input for the next guess
            document.getElementById('guess').value = '';
            document.getElementById('guess').focus(); // Put cursor back in input
        }
        
        function startNewGame() {
            secretNumber = Math.floor(Math.random() * 10) + 1;
            guessCount = 0;
            updateStats();
            
            const resultArea = document.getElementById('result');
            resultArea.innerText = "New game started! I'm thinking of a new number between 1 and 10!";
            resultArea.className = "";
            
            speak("New game! I'm thinking of a secret number between 1 and 10. Can you guess it?");
            
            document.getElementById('guess').value = '';
            document.getElementById('guess').focus();
            
            console.log("New secret number is: " + secretNumber); // Cheat code for testing!
        }
        
        // AUDIO CONTROL FUNCTIONS
        function testAudio() {
            speak("Hello! This is your Number Detective game. Audio is working perfectly!");
        }
        
        function toggleMute() {
            audioEnabled = !audioEnabled;
            const button = document.getElementById('muteToggle');
            button.innerText = audioEnabled ? "üîá Mute" : "üîä Unmute";
            
            if (audioEnabled) {
                speak("Audio turned on!");
            }
        }
        
        function updateSpeechRate() {
            speechRate = document.getElementById('speechRate').value;
            speak("Speech speed is now set to " + Math.round(speechRate * 100) + " percent");
        }
        
        // EVENT LISTENERS - These connect our buttons to our functions
        document.getElementById('submitGuess').addEventListener('click', checkGuess);
        document.getElementById('newGame').addEventListener('click', startNewGame);
        document.getElementById('testAudio').addEventListener('click', testAudio);
        document.getElementById('muteToggle').addEventListener('click', toggleMute);
        document.getElementById('speechRate').addEventListener('change', updateSpeechRate);
        
        // Keyboard shortcuts
        document.getElementById('guess').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                checkGuess();
            }
        });
        
        // Global keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.key === 'n' || event.key === 'N') {
                if (event.ctrlKey || event.metaKey) { // Ctrl+N or Cmd+N
                    event.preventDefault();
                    startNewGame();
                }
            }
            if (event.key === 'm' || event.key === 'M') {
                if (event.ctrlKey || event.metaKey) { // Ctrl+M or Cmd+M
                    event.preventDefault();
                    toggleMute();
                }
            }
        });
        
        // Initialize the game
        updateStats();
        document.getElementById('guess').focus();
        
        // Welcome message
        setTimeout(() => {
            speak("Welcome to Number Detective! I'm thinking of a secret number between 1 and 10. Enter your guess and press the button. Good luck!");
        }, 1000);
    </script>
    
</body>
</html>